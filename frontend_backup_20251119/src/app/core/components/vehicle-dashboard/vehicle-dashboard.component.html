<!-- YourCar Application - Vehicle Dashboard -->
<!-- Functional, Helpful, Beautiful -->

<div class="dashboard" *ngIf="vehicleInfo$ | async as vehicle; else loading">

  <!-- Hero Section: Vehicle Identity -->
  <section class="dashboard-hero" aria-labelledby="vehicle-title">
    <div class="hero-content">
      <div class="hero-icon">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path
            d="M5 17H4C3.45 17 2.98 16.78 2.59 16.41C2.22 16.02 2 15.55 2 15V11L4.48 5.22C4.64 4.84 5 4.5 5.5 4.5H18.5C19 4.5 19.36 4.84 19.52 5.22L22 11V15C22 15.55 21.78 16.02 21.41 16.41C21.02 16.78 20.55 17 20 17H19M6 19.5C6 20.33 6.67 21 7.5 21C8.33 21 9 20.33 9 19.5C9 18.67 8.33 18 7.5 18C6.67 18 6 18.67 6 19.5M15 19.5C15 20.33 15.67 21 16.5 21C17.33 21 18 20.33 18 19.5C18 18.67 17.33 18 16.5 18C15.67 18 15 18.67 15 19.5Z"
            stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
      </div>
      <div class="hero-text">
        <h1 id="vehicle-title" class="hero-title">{{ vehicle.name }}</h1>
        <p class="hero-subtitle" *ngIf="vehicle.vin">VIN: <span class="hero-vin">{{ vehicle.vin }}</span></p>
      </div>
    </div>
    <div class="hero-action">
      <a [routerLink]="['/vehicles']" class="no-underline">
        <mtr-button variant="secondary">
          <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M8 7h12M8 12h12M8 17h12M3 7h.01M3 12h.01M3 17h.01" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          Change Vehicle
        </mtr-button>
      </a>
    </div>
  </section>

  <!-- Quick Access Grid -->
  <section class="dashboard-section" aria-labelledby="quick-access-title">
    <h2 id="quick-access-title" class="section-title">Quick Access</h2>
    <div class="quick-access-grid">

      <!-- Maintenance Schedules -->
      <a [routerLink]="[]" [queryParams]="{articleIdTrail: '-998'}" queryParamsHandling="merge" class="no-underline"
        [attr.aria-label]="'View maintenance schedules for ' + vehicle.name">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-primary">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Maintenance Schedules</h3>
              <p class="card-description">Scheduled service intervals and recommended maintenance</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

      <!-- Repair Procedures -->
      <a [routerLink]="['/docs/Procedures']" [queryParams]="{}" queryParamsHandling="merge" class="no-underline"
        aria-label="View repair procedures">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-success">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2Z"
                  stroke="currentColor" stroke-width="2" />
                <path d="M14 2V8H20M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Repair Procedures</h3>
              <p class="card-description">Step-by-step repair and service instructions</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

      <!-- Wiring Diagrams -->
      <a [routerLink]="['/docs/Diagrams']" [queryParams]="{}" queryParamsHandling="merge" class="no-underline"
        aria-label="View wiring and component diagrams">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-info">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2" />
                <path d="M9 9H9.01M15 9H15.01M9 15H9.01M15 15H15.01M9 12H15" stroke="currentColor" stroke-width="2"
                  stroke-linecap="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Wiring Diagrams</h3>
              <p class="card-description">Electrical schematics and component locations</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

      <!-- Diagnostic Trouble Codes -->
      <a [routerLink]="['/docs/Diagnostic Codes']" [queryParams]="{}" queryParamsHandling="merge" class="no-underline"
        aria-label="View diagnostic trouble codes">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-warning">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"
                  stroke="currentColor" stroke-width="2" />
                <path d="M12 9v4M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Diagnostic Codes</h3>
              <p class="card-description">DTC definitions and troubleshooting guides</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

      <!-- Technical Specifications -->
      <a [routerLink]="['/docs/Specs']" [queryParams]="{}" queryParamsHandling="merge" class="no-underline"
        aria-label="View technical specifications">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-secondary">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                  stroke="currentColor" stroke-width="2" />
                <path d="M9 12h6M9 16h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Technical Specifications</h3>
              <p class="card-description">Detailed specs, capacities, and tolerances</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

      <!-- Service Bulletins -->
      <a [routerLink]="['/docs/Service Bulletins']" [queryParams]="{}" queryParamsHandling="merge" class="no-underline"
        aria-label="View service bulletins">
        <mtr-card class="action-card h-full">
          <div class="card-content-wrapper">
            <div class="card-icon card-icon-error">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" />
              </svg>
            </div>
            <div class="card-text">
              <h3 class="card-title">Service Bulletins</h3>
              <p class="card-description">TSBs, recalls, and technical updates</p>
            </div>
            <svg class="card-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>

    </div>
  </section>

  <!-- Recently Viewed (if enabled and has data) -->
  <section *ngIf="(recentDocuments$ | async)?.length && (userSettingsService.recentVehiclesMode$ | async) === 'Enabled'"
    class="dashboard-section" aria-labelledby="recent-title">
    <h2 id="recent-title" class="section-title">Recently Viewed</h2>
    <div class="recent-list">
      <a *ngFor="let doc of (recentDocuments$ | async)" class="no-underline" [routerLink]="doc.route"
        [queryParams]="doc.queryParams" [attr.aria-label]="'View ' + doc.title">
        <mtr-card class="recent-item">
          <div class="recent-content-wrapper">
            <div class="recent-icon">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                <path d="M9 12h6M9 16h6M9 8h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                <path d="M4 4h16M4 20h16M4 4v16M20 4v16" stroke="currentColor" stroke-width="2" />
              </svg>
            </div>
            <div class="recent-text">
              <span class="recent-title">{{ doc.title }}</span>
              <span class="recent-subtitle">{{ doc.category }}</span>
            </div>
            <svg class="recent-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>
    </div>
  </section>

  <!-- Help Card -->
  <section class="dashboard-section" aria-labelledby="help-title">
    <mtr-card class="help-card">
      <div class="help-content-wrapper">
        <div class="help-icon">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
            <path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3M12 17h.01" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" />
          </svg>
        </div>
        <div class="help-text">
          <h2 id="help-title" class="help-title">Need Help Getting Started?</h2>
          <ul class="help-list">
            <li><strong>Browse by category:</strong> Use the menu on the left to explore all available documentation
            </li>
            <li><strong>Search for topics:</strong> Use the search bar at the top to find specific information</li>
            <li><strong>Quick access:</strong> Click any card above to jump directly to that section</li>
          </ul>
        </div>
      </div>
    </mtr-card>
  </section>

  <!-- Popular Articles (if available) -->
  <section *ngIf="(popularArticles$ | async)?.length" class="dashboard-section" aria-labelledby="popular-title">
    <h2 id="popular-title" class="section-title">Popular for {{ vehicle.name }}</h2>
    <div class="popular-list">
      <a *ngFor="let article of (popularArticles$ | async); let i = index" class="no-underline"
        [routerLink]="article.route" [queryParams]="article.queryParams"
        [attr.aria-label]="'View popular article: ' + article.title">
        <mtr-card class="popular-item">
          <div class="popular-content-wrapper">
            <span class="popular-number">{{ i + 1 }}</span>
            <div class="popular-text">
              <span class="popular-title">{{ article.title }}</span>
              <span class="popular-category">{{ article.category }}</span>
            </div>
            <svg class="popular-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
              aria-hidden="true">
              <path d="M9 18l6-6-6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
          </div>
        </mtr-card>
      </a>
    </div>
  </section>

</div>

<!-- Loading State -->
<ng-template #loading>
  <div class="dashboard-loading">
    <mtr-skeleton height="200px" class="mb-4"></mtr-skeleton>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <mtr-skeleton height="150px"></mtr-skeleton>
      <mtr-skeleton height="150px"></mtr-skeleton>
      <mtr-skeleton height="150px"></mtr-skeleton>
    </div>
  </div>
</ng-template>